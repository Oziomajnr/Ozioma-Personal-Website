<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Communicating between components in Java Using Guava Event Bus | Ozioma Ogbe</title>
<meta name="generator" content="Jekyll v3.8.6" />
<meta property="og:title" content="Communicating between components in Java Using Guava Event Bus" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Hi, I am a Software Engineer and I enjoy solving problems and sharing my solutions, I have worked with many technologies but I am more focused on native android application development for now. I write primarily about software development and I hope to write about chess and start up in the future" />
<meta property="og:description" content="Hi, I am a Software Engineer and I enjoy solving problems and sharing my solutions, I have worked with many technologies but I am more focused on native android application development for now. I write primarily about software development and I hope to write about chess and start up in the future" />
<link rel="canonical" href="https://blog.oziomaogbe.com/2018/08/13/communicating-between-components-in-java-using-guava-event-bus.html" />
<meta property="og:url" content="https://blog.oziomaogbe.com/2018/08/13/communicating-between-components-in-java-using-guava-event-bus.html" />
<meta property="og:site_name" content="Ozioma Ogbe" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-08-13T00:00:00+00:00" />
<script type="application/ld+json">
{"headline":"Communicating between components in Java Using Guava Event Bus","dateModified":"2018-08-13T00:00:00+00:00","description":"Hi, I am a Software Engineer and I enjoy solving problems and sharing my solutions, I have worked with many technologies but I am more focused on native android application development for now. I write primarily about software development and I hope to write about chess and start up in the future","datePublished":"2018-08-13T00:00:00+00:00","url":"https://blog.oziomaogbe.com/2018/08/13/communicating-between-components-in-java-using-guava-event-bus.html","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.oziomaogbe.com/2018/08/13/communicating-between-components-in-java-using-guava-event-bus.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://blog.oziomaogbe.com/feed.xml" title="Ozioma Ogbe" /><script async src="https://www.googletagmanager.com/gtag/js?id=UA-145161693-1"></script>
<script>
  window['ga-disable-UA-145161693-1'] = window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1";
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-145161693-1');
</script>
<!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Communicating between components in Java Using Guava Event Bus | Ozioma Ogbe</title>
<meta name="generator" content="Jekyll v3.8.6" />
<meta property="og:title" content="Communicating between components in Java Using Guava Event Bus" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Hi, I am a Software Engineer and I enjoy solving problems and sharing my solutions, I have worked with many technologies but I am more focused on native android application development for now. I write primarily about software development and I hope to write about chess and start up in the future" />
<meta property="og:description" content="Hi, I am a Software Engineer and I enjoy solving problems and sharing my solutions, I have worked with many technologies but I am more focused on native android application development for now. I write primarily about software development and I hope to write about chess and start up in the future" />
<link rel="canonical" href="https://blog.oziomaogbe.com/2018/08/13/communicating-between-components-in-java-using-guava-event-bus.html" />
<meta property="og:url" content="https://blog.oziomaogbe.com/2018/08/13/communicating-between-components-in-java-using-guava-event-bus.html" />
<meta property="og:site_name" content="Ozioma Ogbe" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-08-13T00:00:00+00:00" />
<script type="application/ld+json">
{"headline":"Communicating between components in Java Using Guava Event Bus","dateModified":"2018-08-13T00:00:00+00:00","description":"Hi, I am a Software Engineer and I enjoy solving problems and sharing my solutions, I have worked with many technologies but I am more focused on native android application development for now. I write primarily about software development and I hope to write about chess and start up in the future","datePublished":"2018-08-13T00:00:00+00:00","url":"https://blog.oziomaogbe.com/2018/08/13/communicating-between-components-in-java-using-guava-event-bus.html","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.oziomaogbe.com/2018/08/13/communicating-between-components-in-java-using-guava-event-bus.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Ozioma Ogbe</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/projects.html">Projects</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
    <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Communicating between components in Java Using Guava Event Bus</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2018-08-13T00:00:00+00:00" itemprop="datePublished">Aug 13, 2018
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p align="center">
 <img src="/img/1h9fw9-AbGIqjEskbK-Rf6A.png" alt="Singleton Diagram" />
</p>

<p>One common situation that arises when building enterprise application is <a href="https://hackernoon.com/tagged/implementing">implementing</a>
a chain of business processes after one process is <a href="https://hackernoon.com/tagged/successful">successful</a>, 
for example, if you are building a shopping website, you might want to do the following after payment for a product is successful</p>

<ol>
  <li>Reduce the number of items available in the store after the purchase.</li>
  <li>Send the shop owner a receipt for the purchase.</li>
  <li>Send the buyer a receipt for the purchase.
In some cases, you might want these processes to be <strong>atomic</strong> with respect to the product purchase,
 that is,** after product purchase occurs the number of items must decrease, revert the product purchase if there is a 
 problem decreasing the number of available items**. You generally would want to do this in a 
 <a href="https://en.wikipedia.org/wiki/Transaction_processing"><strong>transaction</strong></a> to make the process atomic.</li>
</ol>

<p>In some other cases, the second process might not be important enough to revert the execution of the first phase if it 
fails, for example, you might not want the process of sending receipts to the customer or seller to affect the process 
of payment. In such cases, you would want to decouple the components handling both processes as much as
 possible so that they can execute their operations independently, this is where an <strong>Event Bus</strong> would help us.</p>

<p><strong>What Is An Event Bus?</strong></p>

<blockquote>
  <p>An Eventbus is a mechanism that allows different components to communicate with each other without knowing about each
 other. A component can send an Event to the Eventbus without knowing who will pick it up or how many others will 
 pick it up. Components can also listen to Events on an Eventbus, without knowing who sent the Events.
 That way, components can communicate without depending on each other. Also, it is very easy to substitute a component.
  As long as the new component understands the Events that are being sent and received, the other components 
  will never know.
<a href="http://www.rribbit.org/eventbus.html">http://www.rribbit.org/eventbus.html</a>In this tutorial, we would use the 
<a href="https://github.com/google/guava/wiki/EventBusExplained"><strong>Google Guava Event Bus</strong></a> implementation to show how we can 
decouple components in our java applications</p>
</blockquote>

<p>Note: The docs to the library has this to say about the Event Bus</p>

<blockquote>
  <p>EventBus allows publish-subscribe-style communication between components without requiring the components to
 explicitly register with one another (and thus be aware of each other). It is designed exclusively to replace 
 traditional Java in-process event distribution using explicit registration. It is <em>not</em> a 
 general-purpose publish-subscribe system, nor is it intended for interprocess communication. 
 In our example, we would demonstrate how to use an event bus by simulating the payment process mentioned at 
 the beginning of this article.</p>
</blockquote>

<p>So, here is the components involved in our application</p>

<p align="center">
 <img src="/img/1c8D-DnP5FeYjFSv8sKUhZg.png" alt="Singleton Diagram" />
</p>

<p>The first component should handle processes that is involved directly with a
 successful payment, like reducing the number of items left in the store.</p>
<ul>
  <li>The second component handles sending receipt to the customer.</li>
  <li>The third component handles sending, receipt to the Seller.
We could chain these processes together by implementing them in different methods and call them sequentially</li>
</ul>

<p align="center">
 <img src="/img/1kyb5ng5AiA8PHc-5GWZbdw.png" alt="Singleton Diagram" />
</p>

<p>we could have it implemented like this</p>

<p>But the problem with this method is that the components are not properly decoupled and a when an error occurs in one process, 
it could affect the other process. Also, if we have to add more processes to be executed after a successful payment, 
we would have to manually go to the onPaymentRecievedMethod() and add the method call, this is not good and we would 
address this issue using an Event Bus, the <strong>Google Guava Event Bus</strong>.</p>

<p>This is how our implementation would looks like</p>

<p align="center">
 <img src="/img/1A9DhulF8SlpgQ5c-odpuKw.png" alt="Singleton Diagram" />
</p>

<p>The payment component and the receipt sender components are completely unaware of each other,
 the event bus is responsible for carrying the information from the publishers to all the subscribers.</p>

<h4 id="how-does-guava-event-bus-work">How Does Guava Event Bus work?</h4>

<p>Lets have some quick tips.</p>

<ul>
  <li>Some important concepts in the Guava Event Bus are
i. <strong>The Event Bus</strong>: This is the object that is delegated the responsibility of carrying the event data 
from one component to another, you generally would want to have one instance of the event bus so that the 
producer and the subscriber would use the same event bus, this is required for the event bus to work correctly. 
You could use the singleton pattern to ensure that only one instance of this class is created and use an IOC container 
to provide that instance whenever an instance of the event bus is required.</li>
</ul>

<p><em>Note:</em> You could have multiple instances of the Event but if you want different event bus to 
handle different set of components, but just know that a publisher and a subscriber must use the same event bus if 
they must communicate with each other.</p>

<p>ii. <strong>The Producer</strong>: The producer is responsible for emitting the events, these events are then passed on to the
 event bus and are sent to all listeners that are subscribed to that event.</p>

<p>iii. <strong>The Listener</strong>: The listener, subscribes to an event and it is triggered when that event is posted from 
the producer, you could have a listener method run Synchronously or Asynchronously depending on the kind of event bus you use.
 To make the listener method run synchronously, you would use a synchronous Event Bus which is the default 
 <strong>EventBus</strong> class, to have it run asynchronously you would have to use the <strong>AsyncEventBus</strong> class which is a subclass of 
 **EventBus **and its constructor requires an
  <a href="https://docs.oracle.com/javase/7/docs/api/java/util/concurrent/Executor.html"><strong>Executor</strong></a> that would be used to 
  execute the method on a separate thread. In our example, we would use an Asynchronous EventBus.</p>

<p>iv. <strong>The Event</strong>: In Guava event bus, the Event is just a object that is uniquely identified using the name of the class.
 So to create a payment successful event, we just need to create a class PaymentSuccessfulEvent.java and have an instance of that class posted when a payment is successful.</p>

<h4 id="how-to-use-the-event-bus-library"><strong>How to use the Event Bus Library</strong></h4>

<p><strong>1. Add the Google Guava Library to your project</strong></p>

<p>You could do this using your favourite dependency management tool, lets use maven:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
 <span class="nt">&lt;groupId&gt;</span>com.google.guava<span class="nt">&lt;/groupId&gt;</span>
 <span class="nt">&lt;artifactId&gt;</span>guava<span class="nt">&lt;/artifactId&gt;</span>
 <span class="nt">&lt;version&gt;</span>26.0-jre<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>

<p><strong>2. Create factory methods to provide our event bus instance.</strong></p>

<p>We would just use a static class member to hold the instance of the event bus and forget about the complexity of adding 
an IOC container to this demo.</p>

<p>the EventBusFactory class has a method getEventBus() which returns a single instance of an Async event bus.</p>

<p><strong>3. Create the Payment Successful Event.</strong></p>

<p>Like we said earlier, the event is just a simple class and each event is identified by the name of the class.
 So lets create a <strong>PaymentSuccessful</strong> event.</p>

<p>so this event would be posted when a payment is successful.</p>

<p><strong>4. Create Listeners for the Payment Successful Event.</strong></p>

<p>In Guava Event Bus, a listener a method that is decorated with the @Subscribe annotation and it is triggered whenever
 the Event in its argument is posted. Lets create a Payment Successful event listener</p>

<p><strong>5. Register the event listerners.</strong></p>

<p>At the point where the application is started, we have to register the Receipt sender class as an event listener,
 telling guava event bus that it contains methods decorated with @Subscribe annotation. 
 This is done by passing an instance of the RecieptSender class to the eventBus.register() method.</p>

<p><code class="highlighter-rouge">java EventBusFactory.*getEventBus*().register(new RecieptSender());</code></p>

<p><strong>6. Post the event.</strong></p>

<p>We would now post the event whenever a payment is successful.</p>

<p>This would trigger all methods that have the Payment event as their argument and also has the @Subscribe annotation.</p>

<p><strong>Feels free to share you thoughts in the comments, I want to hear your experience implementing this pattern.</strong></p>

  </div><div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = 'https://blog.oziomaogbe.com/2018/08/13/communicating-between-components-in-java-using-guava-event-bus.html';
      this.page.identifier = 'https://blog.oziomaogbe.com/2018/08/13/communicating-between-components-in-java-using-guava-event-bus.html';
    };

    (function() {
      var d = document, s = d.createElement('script');

      s.src = 'https://oziomas-blog.disqus.com/embed.js';

      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript><a class="u-url" href="/2018/08/13/communicating-between-components-in-java-using-guava-event-bus.html" hidden></a>
</article>

    </div>
</main><footer class="site-footer h-card">
    <data class="u-url" href="/"></data>

    <div class="wrapper">

        <div class="footer-col-wrapper">
            <div class="footer-col one-half">
                <h2 class="footer-heading">Ozioma Ogbe</h2>
                <ul class="contact-list">
                    <li class="p-name">{&quot;twitter&quot;=&gt;&quot;oziomajnr&quot;}</li></ul>
            </div>

            <div class="social-links"><ul class="social-media-list"></ul>
</div>
        </div>
        <form action="https://getsimpleform.com/messages?form_api_token=1971f93bf364c88720ddd88d8495d7fe" method="post"
              class='form-inline'>
            <input type='email' name='name' placeholder='Subscribe' class='form-control'/>
            <button type='submit' class='btn btn-primary'>Subscribe</button>
            <input type='hidden' name='redirect_to' value='http://blog.oziomaogbe.com/static/subscribe_thank_you.html'/>
        </form>
    </div>

</footer>
</body>



</html>
